# 局次長スケジュール管理システム - 管理者マニュアル

## 目次

1. [初期設定](#初期設定)
2. [日常業務](#日常業務)
3. [カレンダー共有設定](#カレンダー共有設定)
4. [データ管理](#データ管理)
5. [トラブルシューティング](#トラブルシューティング)

---

## 初期設定

### 1-1. システムへのアクセス

ブラウザで以下のURLにアクセス：
```
https://schedule.your-domain.wakayama-med.ac.jp
```

**推奨ブラウザ**:
- Google Chrome（最新版）
- Microsoft Edge（最新版）

### 1-2. Google連携の設定

初回のみ実施：

1. 画面右上の「**Google連携**」ボタンをクリック
2. 所属するGoogleアカウントを選択
3. 権限の許可画面で「**許可**」をクリック
   - Google Calendarの閲覧・編集権限を求められます
4. ボタンが「**Google連携済み**」に変わることを確認

**注意**:
- 管理者（総務課スタッフ）のGoogleアカウントで認証してください
- 一度認証すれば、全役員のカレンダーを管理できます

### 1-3. 役員のカレンダーID設定

1. 画面右上の「**⚙️ 設定**」→「**役員設定**」をクリック
2. 各役員の行にメールアドレスとカレンダーIDを入力：

| 職位 | メールアドレス | カレンダーID |
|------|---------------|--------------|
| 局長 | director@wakayama-med.ac.jp | director@wakayama-med.ac.jp |
| 事務次長 | admin-deputy@wakayama-med.ac.jp | admin-deputy@wakayama-med.ac.jp |
| 病院次長 | hospital-deputy@wakayama-med.ac.jp | hospital-deputy@wakayama-med.ac.jp |
| 総務課長 | ga-chief@wakayama-med.ac.jp | ga-chief@wakayama-med.ac.jp |
| 総務課副課長 | ga-deputy@wakayama-med.ac.jp | ga-deputy@wakayama-med.ac.jp |

**カレンダーIDとは？**
- 通常はメールアドレスと同じ
- 役員本人のGoogleアカウントのメールアドレスを入力

3. 「**保存**」をクリック
4. カレンダーIDの検証に成功したことを確認

---

## 日常業務

### 2-1. 予定の登録

#### 方法1: ダブルクリックで登録

1. 予定を登録したい**役員の行**と**日付のセル**をダブルクリック
2. ダイアログに以下を入力：
   - **タイトル**（必須）: 例「役員会議」
   - **種類**: 会議/出張/外出/年休/その他
   - **日付**（必須）
   - **終日**チェックボックス: 終日の場合はチェック
   - **時間**: 開始時刻・終了時刻（15分刻み）
   - **場所**: 任意（例：会議室A）
3. 「**保存**」をクリック

#### 自動同期

- 保存と同時にGoogle Calendarに自動同期されます
- 役員のGoogle Calendarを開くと予定が反映されています

### 2-2. 予定の編集

1. 編集したい予定カードをダブルクリック
2. 内容を修正
3. 「**保存**」をクリック

**または削除**:
- 「**削除**」ボタンをクリック
- Google Calendarからも自動的に削除されます

### 2-3. 週の移動

- **◀ 前週** ボタン: 前の週を表示
- **次週 ▶** ボタン: 次の週を表示
- 中央に表示される週の範囲を確認

### 2-4. 印刷

週次スケジュール表を印刷する場合：

1. 「**印刷**」ボタンをクリック
2. 印刷プレビューが表示される
3. 以下の設定を確認：
   - **用紙サイズ**: A4
   - **向き**: 横
   - **カラー/モノクロ**: モノクロ推奨（白黒で見やすいように最適化済み）
4. 「**印刷**」をクリック

### 2-5. Excelエクスポート

週次スケジュールをExcelファイルで出力：

1. 「**Excel出力**」ボタンをクリック
2. ファイル名：`局次長スケジュール_YYYY年MM月DD日〜MM月DD日.xlsx`
3. ダウンロードされたファイルを開く

**用途**:
- 紙での配布資料作成
- メール添付での共有
- アーカイブ保存

---

## カレンダー共有設定

各役員が管理者にカレンダーを共有する必要があります。

### 3-1. 役員側での操作（各役員に依頼）

役員に以下の手順を案内してください：

1. **Google Calendarを開く**
   - https://calendar.google.com/

2. **「マイカレンダー」で自分のカレンダーを選択**
   - 左側のカレンダー一覧から自分の名前のカレンダーをクリック

3. **「⋮」（縦3点メニュー）→「設定と共有」**

4. **「特定のユーザーと共有」セクションで「ユーザーを追加」**
   - 管理者のメールアドレスを入力
     （例：`somu-schedule@wakayama-med.ac.jp`）

5. **権限を「予定の変更」に設定**
   - 必須：「予定の変更」または「変更および共有の管理権限」

6. **「送信」をクリック**

### 3-2. 確認方法

管理者側で確認：

1. Google Calendarを開く
2. 左側の「他のカレンダー」に役員のカレンダーが表示される
3. このシステムの設定画面でカレンダーIDを登録
4. テスト予定を1件作成して同期を確認

---

## データ管理

### 4-1. データのバックアップ

**推奨頻度**: 毎週金曜日

1. 「**⚙️ 設定**」→「**エクスポート**」をクリック
2. JSONファイルがダウンロードされる
   - ファイル名：`schedule-backup-YYYY-MM-DD.json`
3. 以下の場所に保存：
   - 学内共有フォルダ（推奨）
   - 部署のバックアップフォルダ
   - OneDrive/Google Driveなどのクラウドストレージ

**バックアップ内容**:
- 全役員の予定データ
- 役員のカレンダーID設定

### 4-2. データの復元

バックアップファイルから復元する場合：

1. 「**⚙️ 設定**」→「**インポート**」をクリック
2. 以前にエクスポートしたJSONファイルを選択
3. 「既存の予定を保持し、新しい予定を追加」されます
4. 完了メッセージを確認

**注意**:
- インポートは**マージ方式**です
- 既存の予定は削除されません
- 重複する予定がある場合は両方残ります

### 4-3. データの削除（完全リセット）

**警告**: 以下の操作はすべてのデータを削除します。必ずバックアップしてから実行してください。

ブラウザのコンソール（F12キーで開く）で以下を実行：

```javascript
// すべてのデータを削除
localStorage.removeItem('exec-schedule:executives');
localStorage.removeItem('exec-schedule:events');
localStorage.removeItem('exec-schedule:auth');
localStorage.removeItem('exec-schedule:user-email');

// ページをリロード
location.reload();
```

---

## トラブルシューティング

### 問題1: 予定がGoogle Calendarに反映されない

**確認1**: Google連携の状態
- 画面右上のボタンが「**Google連携済み**」になっているか
- なっていない場合：「**Google連携**」ボタンをクリックして再認証

**確認2**: カレンダーIDの設定
- 「⚙️ 設定」→「役員設定」で正しいメールアドレスが入力されているか
- カレンダーIDがメールアドレスと一致しているか

**確認3**: カレンダーの共有設定
- 該当の役員が管理者にカレンダーを共有しているか
- 共有の権限が「予定の変更」になっているか

### 問題2: 「認証トークンが期限切れ」エラー

**解決方法**:
1. 「**Google連携**」ボタンをクリック
2. 再度Googleアカウントで認証
3. ボタンが「Google連携済み」になることを確認

### 問題3: ブラウザがフリーズする・動作が遅い

**原因**: データ量が多すぎる

**解決方法**:
1. 古い予定を削除（3ヶ月以上前の予定）
2. ブラウザのキャッシュをクリア（Ctrl+Shift+Delete）
3. 別のブラウザで試す

### 問題4: 印刷時に予定が見切れる

**解決方法**:
1. 印刷プレビューで「**詳細設定**」を開く
2. 「**余白**」を「なし」または「最小」に変更
3. 「**倍率**」を調整（90%〜100%）

### 問題5: データが消えた

**原因**: ブラウザのデータ削除

**解決方法**:
1. 最新のバックアップファイルを探す
2. 「⚙️ 設定」→「インポート」で復元
3. 復元後、Google Calendarと照合

**予防策**:
- 定期的なバックアップの徹底
- 複数の場所にバックアップを保存

---

## よくある質問（FAQ）

### Q1: 複数の人が同時に編集できますか？

**A**: このシステムは各ブラウザのLocalStorageにデータを保存しています。複数の端末で同時編集すると、最後に保存した内容が優先されます。

**推奨運用**:
- 主担当者を決めて、その担当者が編集する
- 他のスタッフは閲覧のみ（印刷・Excelエクスポート）

### Q2: スマートフォンで使えますか？

**A**: 基本的に使えますが、PC/タブレットでの利用を推奨します。
- 閲覧：可能
- 予定の登録・編集：可能だが操作しづらい
- 印刷：PC推奨

### Q3: 役員が予定を自分で登録できますか？

**A**: 現在の設計では、管理者（総務課スタッフ）のみが登録できます。役員自身がGoogle Calendarで予定を登録しても、このシステムには反映されません（一方向同期）。

### Q4: Google Calendarで予定を削除したら？

**A**: このシステムのデータには影響しません。次回このシステムで予定を編集・保存すると、Google Calendarに再度反映されます。

### Q5: データはどこに保存されますか？

**A**:
- 予定データ：ブラウザのLocalStorage（端末内）
- Google Calendar：各役員のGoogleアカウント

サーバーにはデータを保存していません。

---

## 問い合わせ先

### システム操作方法について
- 総務課内で相談

### Google認証・カレンダー共有について
- 情報システム部門

### システム不具合について
- 情報システム部門

---

**最終更新**: 2025-11-10
**バージョン**: 1.0
